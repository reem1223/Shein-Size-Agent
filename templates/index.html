<!DOCTYPE html>
<html dir="rtl" lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHEIN Size Agent</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; background: #f4f7f6; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .main-card { background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 100%; max-width: 500px; text-align: center; }
        input { width: 90%; padding: 12px; margin: 15px 0; border: 2px solid #ddd; border-radius: 10px; font-size: 16px; outline: none; }
        input:focus { border-color: #000; }
        button { background: #000; color: white; border: none; padding: 12px 30px; border-radius: 10px; cursor: pointer; font-size: 18px; font-weight: bold; transition: 0.3s; }
        button:hover { background: #333; transform: translateY(-2px); }
        
        .result-item { background: #fff; margin-top: 15px; padding: 20px; border-radius: 15px; border: 1px solid #eee; text-align: right; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .best-match { border: 2px solid #2ecc71; background: #f0fff4; }
        
        .progress-bg { background: #eee; border-radius: 10px; height: 12px; margin-top: 12px; overflow: hidden; }
        .progress-fill { height: 100%; border-radius: 10px; transition: width 1s ease-in-out; }
        
        .badge { display: inline-block; padding: 5px 12px; border-radius: 8px; font-size: 12px; margin-bottom: 8px; font-weight: bold; text-transform: uppercase; }
        .best-badge { background: #2ecc71; color: white; }
        #loading { margin-top: 20px; font-style: italic; color: #666; }
    </style>
</head>
<body>

    <div class="main-card">
        <h2>住 转 砖 </h2>
        <p>拽 拽 -SHEIN 拽 爪 拽转</p>
        <input type="text" id="urlInput" placeholder="拽 拽 ...">
        <br>
        <button id="mainBtn" onclick="runAgent()">转 爪专</button>
        
        <div id="loading" style="display:none;">-Agent 住专拽 转 转专... <br>  拽 -10 砖转</div>
        <div id="resultsList" style="margin-top: 20px;"></div>
    </div>

    <script>
        async function runAgent() {
            const url = document.getElementById('urlInput').value;
            if(!url) return alert(" 拽 拽!");

            const btn = document.getElementById('mainBtn');
            const loading = document.getElementById('loading');
            const list = document.getElementById('resultsList');

            btn.disabled = true;
            loading.style.display = "block";
            list.innerHTML = "";

            try {
                const response = await fetch('/analyze', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({url: url})
                });
                
                const data = await response.json();
                loading.style.display = "none";
                btn.disabled = false;

                if(data.error) {
                    list.innerHTML = `<div style="color:red;">砖: ${data.error}</div>`;
                    return;
                }

                data.options.forEach((opt, index) => {
                    const isBest = index === 0;
                    let color = opt.percent > 85 ? "#2ecc71" : (opt.percent > 65 ? "#f1c40f" : "#e74c3c");
                    
                    const div = document.createElement('div');
                    div.className = `result-item ${isBest ? 'best-match' : ''}`;
                    div.innerHTML = `
                        ${isBest ? '<span class="badge best-badge">转  转专</span>' : ''}
                        <div><strong>: ${opt.size}</strong> (${opt.percent}% 转)</div>
                        <div style="font-size: 13px; color: #555; margin-top: 8px; line-height: 1.4;">${opt.details}</div>
                        <div class="progress-bg">
                            <div class="progress-fill" style="width: ${opt.percent}%; background: ${color};"></div>
                        </div>
                    `;
                    list.appendChild(div);
                });

            } catch (e) {
                loading.style.display = "none";
                btn.disabled = false;
                alert("转拽砖专转 注 砖专转 砖. 住 砖.");
            }
        }
    </script>
</body>
</html>