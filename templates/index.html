<!DOCTYPE html>
<html dir="rtl" lang="he">
<head>
    <meta charset="UTF-8">
    <title>SHEIN Size Agent</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; background: #f0f2f5; display: flex; flex-direction: column; align-items: center; padding: 40px; }
        .card { background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); width: 100%; max-width: 450px; text-align: center; }
        input { width: 90%; padding: 12px; margin: 15px 0; border: 2px solid #ddd; border-radius: 10px; font-size: 16px; }
        button { background: #000; color: white; border: none; padding: 12px 30px; border-radius: 10px; cursor: pointer; font-size: 18px; transition: 0.3s; width: 100%; }
        button:hover { background: #333; }
        .result-box { margin-top: 20px; text-align: right; }
        .item { background: #fff; border: 1px solid #eee; padding: 15px; border-radius: 12px; margin-bottom: 10px; }
        .best { border: 2px solid #2ecc71; background: #f0fff4; }
        .bar { background: #eee; height: 10px; border-radius: 5px; margin-top: 10px; overflow: hidden; }
        .fill { height: 100%; transition: width 1s; }
    </style>
</head>
<body>
    <div class="card">
        <h2>住 转 砖 </h2>
        <input type="text" id="url" placeholder="拽 拽 -SHEIN ">
        <button onclick="run()">转 爪专</button>
        <div id="loading" style="display:none; margin-top:15px;">-Agent 转 转...</div>
        <div id="results" class="result-box"></div>
    </div>

    <script>
        async function run() {
            const url = document.getElementById('url').value;
            if(!url) return alert(" 拽 拽!");
            
            document.getElementById('loading').style.display = "block";
            document.getElementById('results').innerHTML = "";

            try {
                const response = await fetch('/analyze', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({url: url})
                });
                const data = await response.json();
                document.getElementById('loading').style.display = "none";

                if(data.error) {
                    document.getElementById('results').innerHTML = `<p style="color:red;">${data.error}</p>`;
                } else {
                    data.options.forEach((opt, i) => {
                        const color = opt.percent > 85 ? '#2ecc71' : (opt.percent > 65 ? '#f1c40f' : '#e74c3c');
                        document.getElementById('results').innerHTML += `
                            <div class="item ${i===0?'best':''}">
                                <strong>: ${opt.size}</strong> (${opt.percent}% 转)
                                <div style="font-size:12px; color:#666;">${opt.details}</div>
                                <div class="bar"><div class="fill" style="width:${opt.percent}%; background:${color};"></div></div>
                            </div>`;
                    });
                }
            } catch(e) {
                document.getElementById('loading').style.display = "none";
                alert("砖转 转拽砖专转 注 砖专转");
            }
        }
    </script>
</body>
</html>